<?xml version="1.0" encoding="utf-8" ?>

<metal:block
    xmlns="http://www.economics-ejournal.org/namespaces/cover"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal">
    
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:fo="http://www.w3.org/1999/XSL/Format"
								version="1.0">
<xsl:decimal-format name="de" decimal-separator="," grouping-separator="."/>
								
<xsl:template match="/">

    <!-- TODO:
         -  Fußzeile Journalarticle steht Germany in zweiter Zeile   
         -  Hyphenation wieder einbauen
         -  Logodatei in anderen Pfad legen (ej/data z.B. oder evtl. als ressource in plone
         -  URL in Infozeile
    -->

	<fo:root
	font-family="Times" 
    font-selection-strategy="character-by-character" 
    font-size="10pt"
	>
	
		<fo:layout-master-set>
			
			<fo:simple-page-master master-name="DiscussionPaper"
				page-width="210mm" page-height="297mm"
				margin-top="1.5cm" margin-bottom="1.25cm" margin-left="3.6cm"
				margin-right="3.6cm">
				<fo:region-body margin-top="2.5cm" />
				<fo:region-before extent="2cm" />
                <fo:region-after extent="1cm" />
            </fo:simple-page-master>

            <fo:simple-page-master master-name="JournalPaper"
				page-width="176mm" page-height="250mm"
				margin-top="1.5cm" margin-bottom="1cm" margin-left="3cm"
                margin-right="1.5cm">
                <fo:region-body margin-top="1.5cm" />
				<fo:region-before extent="1cm" />
				<fo:region-after extent="0cm" />
			</fo:simple-page-master>
        
        </fo:layout-master-set>

        <!-- dirty trick ;-) --> 
        <fo:page-sequence tal:attributes="master-reference context/portal_type">
               
            <fo:static-content flow-name="xsl-region-after"
                font-size="8pt" font-family="Helvetica">
                <fo:block>
                    © Author(s) <fo:inline tal:replace="view/get_publish_year" />. Licensed under a Creative Commons License
                    - Attribution-NonCommercial 2.0 Germany
                </fo:block>
            </fo:static-content>
            <fo:flow flow-name="xsl-region-body">
						
                <!-- Logo --> 
                
                <xsl:if test="/cover/portal_type = 'Discussion Paper'">
                    <fo:block-container absolute-position="fixed" top="0.5cm" 
                        left="1cm">
                        <fo:block >
                            <!-- TODO Logo woanders hin, bzw. gleich in Plone
                                 resource directory laden -->
                            <fo:external-graphic 
                                content-height="100%" content-width="100%"
                                src="file:///home/bunke/ejdev/zbw.ejpdf/zbw/ejpdf/example_files/logo3.tif" />
                        </fo:block>
                    </fo:block-container>

                </xsl:if>
                    
               <xsl:if test="/cover/portal_type = 'Journal Article'">
                    <fo:block-container absolute-position="fixed" top="0.5cm" 
                        left="1cm">
                        <fo:block >
                            <!-- TODO Logo woanders hin, bzw. gleich in Plone
                                 resource directory laden -->
                            <fo:external-graphic 
                                content-height="75%" content-width="75%"
                                src="file:///home/bunke/ejdev/zbw.ejpdf/zbw/ejpdf/example_files/logo3.tif" />
                        </fo:block>
                    </fo:block-container>

                </xsl:if>
                
                    <!-- infozeile -->
                    <fo:block-container space-before="6px"
                        font-family="Helvetica"
                        font-size="8pt">

                        <xsl:if test="/cover/portal_type = 'Discussion Paper'">
                            <fo:block font-weight="bold">
                                <xsl:value-of select="/cover/portal_type" />
                            </fo:block>
                        </xsl:if>
                        
                        <fo:block>
                            
                            <xsl:if test="/cover/portal_type = 'Discussion Paper'">
                                <fo:inline>
                                No. 
                                </fo:inline>
                            </xsl:if>
                            <xsl:if test="/cover/portal_type = 'Journal Article'">
                                <fo:inline>
                                Vol. 
                                    <fo:inline tal:replace="view/get_volume" />, 
                                </fo:inline>
                            </xsl:if>
                                
                            
                            <fo:inline><xsl:value-of select="/cover/id" /></fo:inline> |
                            <fo:inline><xsl:value-of select="/cover/date" /></fo:inline> |
                            <fo:inline color="darkblue">
                                <fo:basic-link external-destination="http://xyz.com">
                                    <xsl:value-of select="//cover/url" />
                                </fo:basic-link>
                            </fo:inline>
                        
                        </fo:block>
                    </fo:block-container>


                    
                    
                    <fo:block
                        
                        font-size="17pt"
                        font-weight="bold"
                        text-align="center"
                        space-before="2cm">

                        <xsl:value-of select="/cover/title" />
                    
                    </fo:block>
                    
                    
                    <fo:block-container
                        font-style="italic"
                        space-before="0.5cm"
                        text-align="center">
                        <fo:block>

                            <xsl:for-each select="//author">
                                 <fo:inline font-size="14pt" keep-together.within-line="always">
                                     <xsl:value-of select="name" />
                                     <xsl:if test="position() != last()">, </xsl:if>
                                </fo:inline>
                            </xsl:for-each>



                            <!--    <xsl:apply-templates match="//author" />
                                    -->
                        </fo:block>
                    
                    </fo:block-container>

                    
                    <!-- abstract -->
                    <fo:block text-align="justify" space-before="18px" language="en" hyphenate="false">
                        <fo:inline font-weight="bold" padding-right="9px">Abstract </fo:inline>
                        <xsl:value-of select="/cover/abstract/p" />
                    </fo:block>
    
                    <fo:block text-align="justify" space-before="12px">
                        <xsl:value-of select="/cover/abstract/p[2]" />
                    
                    </fo:block>
                    
                    <fo:block-container font-size="10px" space-before="6px">

                    <fo:block>
                        <fo:inline font-weight="bold" padding-right="9px">JEL </fo:inline>
                        <xsl:for-each select="/cover/jels/jel">
                            <fo:inline padding-right="6px"><xsl:value-of select="." />
                            </fo:inline>
                        </xsl:for-each>
                    </fo:block>

                    <fo:block space-before="6px">
                        <fo:inline font-weight="bold" padding-right="9px">Keywords</fo:inline> 
                        <xsl:value-of select="/cover/keywords" />
                    </fo:block>

                    <fo:block space-before="6px">
                        <fo:inline font-weight="bold" padding-right="9px">
                            Authors
                        </fo:inline>
                        <xsl:for-each select="//author">
                            <fo:block>
                                <xsl:value-of select="name" />,
                                <fo:inline font-style="italic">
                                    <xsl:value-of select="affil" />
                                </fo:inline>
                            </fo:block>
                        </xsl:for-each>
                    
                    </fo:block>
                    
                    <fo:block space-before="6px">
                        <fo:inline font-weight="bold" padding-right="9px">Correspondence</fo:inline> 
                        <xsl:value-of select="/cover/correspondence" /> 
                        E-mail:
                        <fo:inline><xsl:value-of select="/cover/email" /></fo:inline>
                    </fo:block>

                </fo:block-container>

                <fo:block-container space-before="12px" font-size="8px">
                    
                    <fo:block>
                    <fo:inline font-weight="bold" padding-right="6px">Citation </fo:inline>
                        <xsl:value-of select="/cover/citation" />
                    </fo:block>
                    
                    <fo:block space-before="6px" font-style="italic">
                        <xsl:value-of select="/cover/additional" /> 
                    </fo:block>
                
                </fo:block-container>

               

               </fo:flow>

			</fo:page-sequence>

	</fo:root>
	
</xsl:template>


</xsl:stylesheet>
</metal:block>
